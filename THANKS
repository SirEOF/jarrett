This code was deeply inspired by c0n and mikhail by xenion <xenion@antifork.org>.
